(self.webpackChunkngx_your_message=self.webpackChunkngx_your_message||[]).push([[349],{4447:(e,t,n)=>{"use strict";n.d(t,{l:()=>o,t:()=>r});class o{constructor(e,t){this.data=e,this.pagination=t}}class r{constructor(e,t,n,o,r){this._first=e,this._page=t,this._totalPage=n,this._rows=r,this._totalItem=o}get totalItem(){return this._totalItem}get totalPage(){return this._totalPage}get first(){return this._first}get page(){return this._page}get rows(){return this._rows}}},957:(e,t,n)=>{"use strict";n.d(t,{h:()=>j});var o,r=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(t,n){var o=this,r=this.constructor.prototype;return(o=e.call(this,t)||this).statusCode=n,o.__proto__=r,o}return r(t,e),t}(Error),i=function(e){function t(t){void 0===t&&(t="A timeout occurred.");var n=this,o=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=o,n}return r(t,e),t}(Error),a=function(e){return e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None",e}({}),c=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},l=function(){return function(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}(),h=function(e){function t(t){var n=e.call(this)||this;return n.logger=t,n}return c(t,e),t.prototype.send=function(e){var t=this;return new Promise(function(n,o){var r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=!0,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),e.headers&&Object.keys(e.headers).forEach(function(t){return r.setRequestHeader(t,e.headers[t])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){r.abort()}),e.timeout&&(r.timeout=e.timeout),r.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?n(new l(r.status,r.statusText,r.response||r.responseText)):o(new s(r.statusText,r.status))},r.onerror=function(){t.logger.log(a.Warning,"Error from HTTP request. "+r.status+": "+r.statusText),o(new s(r.statusText,r.status))},r.ontimeout=function(){t.logger.log(a.Warning,"Timeout from HTTP request."),o(new i)},r.send(e.content||"")})},t}(function(){function e(){}return e.prototype.get=function(e,t){return this.send(u({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(u({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(u({},t,{method:"DELETE",url:e}))},e}()),p=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var n=t.split(e.RecordSeparator);return n.pop(),n},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}(),d=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}(),f=function(){function e(){}return e.isRequired=function(e,t){if(null==e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,n){if(!(e in t))throw new Error("Unknown "+n+" value: "+e+".")},e}();function g(e,t){var n=null;return y(e)?(n="Binary data of length "+e.byteLength,t&&(n+=". Content: '"+function(e){var t=new Uint8Array(e),n="";return t.forEach(function(e){n+="0x"+(e<16?"0":"")+e.toString(16)+" "}),n.substr(0,n.length-1)}(e)+"'")):"string"==typeof e&&(n="String data of length "+e.length,t&&(n+=". Content: '"+e+"'.")),n}function m(e,t,n,o,r,s,i){return c=this,void 0,l=function(){var c,u,l,h;return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(a){s=[6,a],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,function(p){switch(p.label){case 0:return[4,r()];case 1:return(l=p.sent())&&((c={}).Authorization="Bearer "+l,u=c),e.log(a.Trace,"("+t+" transport) sending data. "+g(s,i)+"."),[4,n.post(o,{content:s,headers:u})];case 2:return h=p.sent(),e.log(a.Trace,"("+t+" transport) request complete. Response status: "+h.statusCode+"."),[2]}})},new((u=void 0)||(u=Promise))(function(e,t){function n(e){try{r(l.next(e))}catch(n){t(n)}}function o(e){try{r(l.throw(e))}catch(n){t(n)}}function r(t){t.done?e(t.value):new u(function(e){e(t.value)}).then(n,o)}r((l=l.apply(c,[])).next())});var c,u,l}var v=function(){function e(e){this.observers=[],this.cancelCallback=e}return e.prototype.next=function(e){for(var t=0,n=this.observers;t<n.length;t++)n[t].next(e)},e.prototype.error=function(e){for(var t=0,n=this.observers;t<n.length;t++){var o=n[t];o.error&&o.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var n=t[e];n.complete&&n.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new b(this,e)},e}(),b=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(e){})},e}(),w=function(){function e(e){this.minimumLogLevel=e}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case a.Critical:case a.Error:console.error(a[e]+": "+t);break;case a.Warning:console.warn(a[e]+": "+t);break;case a.Information:console.info(a[e]+": "+t);break;default:console.log(a[e]+": "+t)}},e}();function y(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}var S=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return p.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var t,n;if(y(e)){var o=new Uint8Array(e);if(-1===(s=o.indexOf(p.RecordSeparatorCode)))throw new Error("Message is incomplete.");var r=s+1;t=String.fromCharCode.apply(null,o.slice(0,r)),n=o.byteLength>r?o.slice(r).buffer:null}else{var s,i=e;if(-1===(s=i.indexOf(p.RecordSeparator)))throw new Error("Message is incomplete.");t=i.substring(0,r=s+1),n=i.length>r?i.substring(r):null}var a=p.parse(t);return[n,JSON.parse(a[0])]},e}(),C=function(e){return e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close",e}({}),I=function(){function e(e,t,n){var o=this;f.isRequired(e,"connection"),f.isRequired(t,"logger"),f.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.logger=t,this.protocol=n,this.connection=e,this.handshakeProtocol=new S,this.connection.onreceive=function(e){return o.processIncomingData(e)},this.connection.onclose=function(e){return o.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0}return e.create=function(t,n,o){return new e(t,n,o)},e.prototype.start=function(){return e=this,void 0,n=function(){var e;return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(a){s=[6,a],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,function(t){switch(t.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(a.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,[4,this.connection.start(this.protocol.transferFormat)];case 1:return t.sent(),this.logger.log(a.Debug,"Sending handshake request."),[4,this.connection.send(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return t.sent(),this.logger.log(a.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.configureTimeout(),[2]}})},new((t=void 0)||(t=Promise))(function(o,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function i(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){e.done?o(e.value):new t(function(t){t(e.value)}).then(s,i)}a((n=n.apply(e,[])).next())});var e,t,n},e.prototype.stop=function(){return this.logger.log(a.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.connection.stop()},e.prototype.stream=function(e){for(var t=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=this.createStreamInvocation(e,n),s=new v(function(){var e=t.createCancelInvocation(r.invocationId),n=t.protocol.writeMessage(e);return delete t.callbacks[r.invocationId],t.connection.send(n)});this.callbacks[r.invocationId]=function(e,t){t?s.error(t):e.type===C.Completion?e.error?s.error(new Error(e.error)):s.complete():s.next(e.item)};var i=this.protocol.writeMessage(r);return this.connection.send(i).catch(function(e){s.error(e),delete t.callbacks[r.invocationId]}),s},e.prototype.send=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.createInvocation(e,t,!0),r=this.protocol.writeMessage(o);return this.connection.send(r)},e.prototype.invoke=function(e){for(var t=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=this.createInvocation(e,n,!1),s=new Promise(function(e,n){t.callbacks[r.invocationId]=function(t,o){if(o)n(o);else if(t.type===C.Completion){var r=t;r.error?n(new Error(r.error)):e(r.result)}else n(new Error("Unexpected message type: "+t.type))};var o=t.protocol.writeMessage(r);t.connection.send(o).catch(function(e){n(e),delete t.callbacks[r.invocationId]})});return s},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var n=this.methods[e];if(n)if(t){var o=n.indexOf(t);-1!==o&&(n.splice(o,1),0===n.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,n=this.protocol.parseMessages(e,this.logger);t<n.length;t++){var o=n[t];switch(o.type){case C.Invocation:this.invokeClientMethod(o);break;case C.StreamItem:case C.Completion:var r=this.callbacks[o.invocationId];null!=r&&(o.type===C.Completion&&delete this.callbacks[o.invocationId],r(o));break;case C.Ping:break;case C.Close:this.logger.log(a.Information,"Close message received from server."),this.connection.stop(o.error?new Error("Server returned an error on close: "+o.error):null);break;default:this.logger.log(a.Warning,"Invalid message type: "+o.type)}}this.configureTimeout()},e.prototype.processHandshakeResponse=function(e){var t,n,o;try{o=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],n=t[1]}catch(i){var r;this.logger.log(a.Error,r="Error parsing handshake response: "+i);var s=new Error(r);throw this.connection.stop(s),s}return n.error?(this.logger.log(a.Error,r="Server returned handshake error: "+n.error),this.connection.stop(new Error(r))):this.logger.log(a.Debug,"Server handshake complete."),o},e.prototype.configureTimeout=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return e.serverTimeout()},this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,n=this.methods[e.target.toLowerCase()];if(n){if(n.forEach(function(n){return n.apply(t,e.arguments)}),e.invocationId){var o="Server requested a response, which is not supported in this version of the client.";this.logger.log(a.Error,o),this.connection.stop(new Error(o))}}else this.logger.log(a.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){var t=this,n=this.callbacks;this.callbacks={},Object.keys(n).forEach(function(t){(0,n[t])(void 0,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.closedCallbacks.forEach(function(n){return n.apply(t,[e])})},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,n){if(n)return{arguments:t,target:e,type:C.Invocation};var o=this.id;return this.id++,{arguments:t,invocationId:o.toString(),target:e,type:C.Invocation}},e.prototype.createStreamInvocation=function(e,t){var n=this.id;return this.id++,{arguments:t,invocationId:n.toString(),target:e,type:C.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:C.CancelInvocation}},e}(),T=function(e){return e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling",e}({}),k=function(e){return e[e.Text=1]="Text",e[e.Binary=2]="Binary",e}({}),M=function(){function e(){this.isAborted=!1}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}(),x=function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function i(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,a)}c((o=o.apply(e,t||[])).next())})},R=function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(a){s=[6,a],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},P=function(){function e(e,t,n,o,r){this.httpClient=e,this.accessTokenFactory=t||function(){return null},this.logger=n,this.pollAbort=new M,this.logMessageContent=o,this.shutdownTimeout=r||5e3}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return x(this,void 0,void 0,function(){var n,o,r,i,c;return R(this,function(u){switch(u.label){case 0:if(f.isRequired(e,"url"),f.isRequired(t,"transferFormat"),f.isIn(t,k,"transferFormat"),this.url=e,this.logger.log(a.Trace,"(LongPolling transport) Connecting"),t===k.Binary&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:9e4},t===k.Binary&&(n.responseType="arraybuffer"),[4,this.accessTokenFactory()];case 1:return o=u.sent(),this.updateHeaderToken(n,o),i=e+"&_="+Date.now(),this.logger.log(a.Trace,"(LongPolling transport) polling: "+i),[4,this.httpClient.get(i,n)];case 2:return 200!==(c=u.sent()).statusCode?(this.logger.log(a.Error,"(LongPolling transport) Unexpected response code: "+c.statusCode),r=new s(c.statusText,c.statusCode),this.running=!1):this.running=!0,this.poll(this.url,n,r),[2,Promise.resolve()]}})})},e.prototype.updateHeaderToken=function(e,t){t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t,n){return x(this,void 0,void 0,function(){var o,r,c,u;return R(this,function(l){switch(l.label){case 0:l.trys.push([0,,8,9]),l.label=1;case 1:return this.running?[4,this.accessTokenFactory()]:[3,7];case 2:o=l.sent(),this.updateHeaderToken(t,o),l.label=3;case 3:return l.trys.push([3,5,,6]),r=e+"&_="+Date.now(),this.logger.log(a.Trace,"(LongPolling transport) polling: "+r),[4,this.httpClient.get(r,t)];case 4:return 204===(c=l.sent()).statusCode?(this.logger.log(a.Information,"(LongPolling transport) Poll terminated by server"),this.running=!1):200!==c.statusCode?(this.logger.log(a.Error,"(LongPolling transport) Unexpected response code: "+c.statusCode),n=new s(c.statusText,c.statusCode),this.running=!1):c.content?(this.logger.log(a.Trace,"(LongPolling transport) data received. "+g(c.content,this.logMessageContent)),this.onreceive&&this.onreceive(c.content)):this.logger.log(a.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return u=l.sent(),this.running?u instanceof i?this.logger.log(a.Trace,"(LongPolling transport) Poll timed out, reissuing."):(n=u,this.running=!1):this.logger.log(a.Trace,"(LongPolling transport) Poll errored after shutdown: "+u.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.stopped=!0,this.shutdownTimer&&clearTimeout(this.shutdownTimer),this.onclose&&(this.logger.log(a.Trace,"(LongPolling transport) Firing onclose event. Error: "+(n||"<undefined>")),this.onclose(n)),this.logger.log(a.Trace,"(LongPolling transport) Transport finished."),[7];case 9:return[2]}})})},e.prototype.send=function(e){return x(this,void 0,void 0,function(){return R(this,function(t){return this.running?[2,m(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return x(this,void 0,void 0,function(){var e,t,n=this;return R(this,function(o){switch(o.label){case 0:return o.trys.push([0,,3,4]),this.running=!1,this.logger.log(a.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.accessTokenFactory()];case 1:return t=o.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 2:return o.sent(),this.logger.log(a.Trace,"(LongPolling transport) DELETE request accepted."),[3,4];case 3:return this.stopped||(this.shutdownTimer=setTimeout(function(){n.logger.log(a.Warning,"(LongPolling transport) server did not terminate after DELETE request, canceling poll."),n.pollAbort.abort()},this.shutdownTimeout)),[7];case 4:return[2]}})})},e}(),E=function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function i(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,a)}c((o=o.apply(e,t||[])).next())})},U=function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(a){s=[6,a],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},N=function(){function e(e,t,n,o){this.httpClient=e,this.accessTokenFactory=t||function(){return null},this.logger=n,this.logMessageContent=o}return e.prototype.connect=function(e,t){return E(this,void 0,void 0,function(){var n,o=this;return U(this,function(r){switch(r.label){case 0:if(f.isRequired(e,"url"),f.isRequired(t,"transferFormat"),f.isIn(t,k,"transferFormat"),"undefined"==typeof EventSource)throw new Error("'EventSource' is not supported in your environment.");return this.logger.log(a.Trace,"(SSE transport) Connecting"),[4,this.accessTokenFactory()];case 1:return(n=r.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),this.url=e,[2,new Promise(function(n,r){var s=!1;t!==k.Text&&r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));var i=new EventSource(e,{withCredentials:!0});try{i.onmessage=function(e){if(o.onreceive)try{o.logger.log(a.Trace,"(SSE transport) data received. "+g(e.data,o.logMessageContent)+"."),o.onreceive(e.data)}catch(t){return void(o.onclose&&o.onclose(t))}},i.onerror=function(e){var t=new Error(e.message||"Error occurred");s?o.close(t):r(t)},i.onopen=function(){o.logger.log(a.Information,"SSE connected to "+o.url),o.eventSource=i,s=!0,n()}}catch(c){return Promise.reject(c)}})]}})})},e.prototype.send=function(e){return E(this,void 0,void 0,function(){return U(this,function(t){return this.eventSource?[2,m(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=null,this.onclose&&this.onclose(e))},e}(),_=function(){function e(e,t,n){this.logger=t,this.accessTokenFactory=e||function(){return null},this.logMessageContent=n}return e.prototype.connect=function(e,t){return n=this,void 0,r=function(){var n,o=this;return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(a){s=[6,a],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,function(r){switch(r.label){case 0:if(f.isRequired(e,"url"),f.isRequired(t,"transferFormat"),f.isIn(t,k,"transferFormat"),"undefined"==typeof WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return this.logger.log(a.Trace,"(WebSockets transport) Connecting"),[4,this.accessTokenFactory()];case 1:return(n=r.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),[2,new Promise(function(n,r){e=e.replace(/^http/,"ws");var s=new WebSocket(e);t===k.Binary&&(s.binaryType="arraybuffer"),s.onopen=function(t){o.logger.log(a.Information,"WebSocket connected to "+e),o.webSocket=s,n()},s.onerror=function(e){r(e.error)},s.onmessage=function(e){o.logger.log(a.Trace,"(WebSockets transport) data received. "+g(e.data,o.logMessageContent)+"."),o.onreceive&&o.onreceive(e.data)},s.onclose=function(e){o.logger.log(a.Trace,"(WebSockets transport) socket closed."),o.onclose&&(!1===e.wasClean||1e3!==e.code?o.onclose(new Error("Websocket closed with status code: "+e.code+" ("+e.reason+")")):o.onclose())}})]}})},new((o=void 0)||(o=Promise))(function(e,t){function s(e){try{a(r.next(e))}catch(n){t(n)}}function i(e){try{a(r.throw(e))}catch(n){t(n)}}function a(t){t.done?e(t.value):new o(function(e){e(t.value)}).then(s,i)}a((r=r.apply(n,[])).next())});var n,o,r},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===WebSocket.OPEN?(this.logger.log(a.Trace,"(WebSockets transport) sending data. "+g(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.close(),this.webSocket=null),Promise.resolve()},e}(),A=function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function i(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,a)}c((o=o.apply(e,t||[])).next())})},O=function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(a){s=[6,a],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},F=function(){function e(e,t){var n;void 0===t&&(t={}),this.features={},f.isRequired(e,"url"),this.logger=void 0===(n=t.logger)?new w(a.Information):null===n?d.instance:n.log?n:new w(n),this.baseUrl=this.resolveUrl(e),(t=t||{}).accessTokenFactory=t.accessTokenFactory||function(){return null},t.logMessageContent=t.logMessageContent||!1,this.httpClient=t.httpClient||new h(this.logger),this.connectionState=2,this.options=t}return e.prototype.start=function(e){return f.isIn(e=e||k.Binary,k,"transferFormat"),this.logger.log(a.Debug,"Starting connection with transfer format '"+k[e]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(e),this.startPromise)},e.prototype.send=function(e){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(e)},e.prototype.stop=function(e){return A(this,void 0,void 0,function(){return O(this,function(t){switch(t.label){case 0:this.connectionState=2,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:case 3:return t.sent(),[3,4];case 4:return this.transport?(this.stopError=e,[4,this.transport.stop()]):[3,6];case 5:t.sent(),this.transport=null,t.label=6;case 6:return[2]}})})},e.prototype.startInternal=function(e){return A(this,void 0,void 0,function(){var t,n,o,r,s,i,c,u=this;return O(this,function(l){switch(l.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,l.label=1;case 1:return l.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==T.WebSockets?[3,3]:(this.transport=this.constructTransport(T.WebSockets),[4,this.transport.connect(t,e)]):[3,5];case 2:return l.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,o=0,r=function(){var e;return O(this,function(r){switch(r.label){case 0:return[4,s.getNegotiationResponse(t)];case 1:return n=r.sent(),2===s.connectionState?[2,{value:void 0}]:(n.url&&(t=n.url),n.accessToken&&(e=n.accessToken,s.accessTokenFactory=function(){return e}),o++,[2])}})},s=this,l.label=6;case 6:return[5,r()];case 7:if("object"==typeof(i=l.sent()))return[2,i.value];l.label=8;case 8:if(n.url&&o<100)return[3,6];l.label=9;case 9:if(100===o&&n.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,n,e)];case 10:l.sent(),l.label=11;case 11:return this.transport instanceof P&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return u.stopConnection(e)},this.changeState(0,1),[3,13];case 12:throw c=l.sent(),this.logger.log(a.Error,"Failed to start the connection: "+c),this.connectionState=2,this.transport=null,c;case 13:return[2]}})})},e.prototype.getNegotiationResponse=function(e){return A(this,void 0,void 0,function(){var t,n,o,r,s,i;return O(this,function(c){switch(c.label){case 0:return[4,this.accessTokenFactory()];case 1:(n=c.sent())&&((t={}).Authorization="Bearer "+n,o=t),r=this.resolveNegotiateUrl(e),this.logger.log(a.Debug,"Sending negotiation request: "+r),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.httpClient.post(r,{content:"",headers:o})];case 3:if(200!==(s=c.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+s.statusCode);return[2,JSON.parse(s.content)];case 4:throw i=c.sent(),this.logger.log(a.Error,"Failed to complete negotiation with the server: "+i),i;case 5:return[2]}})})},e.prototype.createConnectUrl=function(e,t){return e+(-1===e.indexOf("?")?"?":"&")+"id="+t},e.prototype.createTransport=function(e,t,n,o){return A(this,void 0,void 0,function(){var r,s,i,c,u,l;return O(this,function(h){switch(h.label){case 0:return r=this.createConnectUrl(e,n.connectionId),this.isITransport(t)?(this.logger.log(a.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.transport.connect(r,o)]):[3,2];case 1:return h.sent(),this.changeState(0,1),[2];case 2:s=0,i=n.availableTransports,h.label=3;case 3:return s<i.length?(c=i[s],this.connectionState=0,"number"!=typeof(u=this.resolveTransport(c,t,o))?[3,8]:(this.transport=this.constructTransport(u),null!==n.connectionId?[3,5]:[4,this.getNegotiationResponse(e)])):[3,9];case 4:n=h.sent(),r=this.createConnectUrl(e,n.connectionId),h.label=5;case 5:return h.trys.push([5,7,,8]),[4,this.transport.connect(r,o)];case 6:return h.sent(),this.changeState(0,1),[2];case 7:return l=h.sent(),this.logger.log(a.Error,"Failed to start the transport '"+T[u]+"': "+l),this.connectionState=2,n.connectionId=null,[3,8];case 8:return s++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},e.prototype.constructTransport=function(e){switch(e){case T.WebSockets:return new _(this.accessTokenFactory,this.logger,this.options.logMessageContent);case T.ServerSentEvents:return new N(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent);case T.LongPolling:return new P(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.resolveTransport=function(e,t,n){var o=T[e.transport];if(null==o)this.logger.log(a.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client.");else{var r=e.transferFormats.map(function(e){return k[e]});if(function(e,t){return!e||0!=(t&e)}(t,o))if(r.indexOf(n)>=0){if(!(o===T.WebSockets&&"undefined"==typeof WebSocket||o===T.ServerSentEvents&&"undefined"==typeof EventSource))return this.logger.log(a.Debug,"Selecting transport '"+T[o]+"'"),o;this.logger.log(a.Debug,"Skipping transport '"+T[o]+"' because it is not supported in your environment.'")}else this.logger.log(a.Debug,"Skipping transport '"+T[o]+"' because it does not support the requested transfer format '"+k[n]+"'.");else this.logger.log(a.Debug,"Skipping transport '"+T[o]+"' because it was disabled by the client.")}return null},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.changeState=function(e,t){return this.connectionState===e&&(this.connectionState=t,!0)},e.prototype.stopConnection=function(e){return A(this,void 0,void 0,function(){return O(this,function(t){return this.transport=null,(e=this.stopError||e)?this.logger.log(a.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(a.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(e),[2]})})},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(a.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),n=e.substring(0,-1===t?e.length:t);return"/"!==n[n.length-1]&&(n+="/"),(n+="negotiate")+(-1===t?"":e.substring(t))},e}(),H=function(){function e(){this.name="json",this.version=1,this.transferFormat=k.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=d.instance);for(var n=[],o=0,r=p.parse(e);o<r.length;o++){var s=JSON.parse(r[o]);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case C.Invocation:this.isInvocationMessage(s);break;case C.StreamItem:this.isStreamItemMessage(s);break;case C.Completion:this.isCompletionMessage(s);break;case C.Ping:case C.Close:break;default:t.log(a.Information,"Unknown message type '"+s.type+"' ignored.");continue}n.push(s)}return n},e.prototype.writeMessage=function(e){return p.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}(),D=function(){function e(){}return e.prototype.configureLogging=function(e){return f.isRequired(e,"logging"),this.logger=void 0!==e.log?e:new w(e),this},e.prototype.withUrl=function(e,t){return f.isRequired(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?t:{transport:t},this},e.prototype.withHubProtocol=function(e){return f.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new F(this.url,e);return I.create(t,this.logger||d.instance,this.protocol||new H)},e}(),L=n(5959),q=n(529),G=n(8619),W=n(5031);let j=(()=>{class e{constructor(e){this.authenticationService=e,this.signalRUrl=q.N.chatHubUrl,this.userId="",this.connected=!1,this.userAMinutePassed=new L.xQ,this.userHaveNewRoom=new L.xQ,this.userHaveNewMessage=new L.xQ,this.readMessageFromRoom=new L.xQ,this.updateMessageStatusToUser=new L.xQ,this.typingMessageToUser=new L.xQ,this.userConnectionStatus=new L.xQ,this.removeMessageToUser=new L.xQ,this.editMessageToUser=new L.xQ,this.roomUpdateDataToUser=new L.xQ,this.callVideoToUser=new L.xQ,this.userAcceptOrRejectCall=new L.xQ,this.userExitCall=new L.xQ,this.numberOfRoomUnreadMessage=new L.xQ,this.memberUpdateNicknameToUser=new L.xQ,this.userOutRoom=new L.xQ,this.newMessageToRoom=new L.xQ,this.forwardMessageToRoom=new L.xQ,this.updateMessageStatusInRoom=new L.xQ,this.connectedSub=new L.xQ,this.userReadMessage=new L.xQ,this.userTypingMessage=new L.xQ,this.removeMessageFromRoom=new L.xQ,this.editMessageToRoom=new L.xQ,this.roomHaveNewUser=new L.xQ,this.roomUpdateDataToRoom=new L.xQ,this.memberUpdateNicknameInRoom=new L.xQ,this.roomUpdateAdministrator=new L.xQ,this.roomRemoveMember=new L.xQ,this.disconnection=()=>this.hubConnection.stop().then(()=>{this.connected=!1,this.connectedSub.next(!1)}),this.authenticationService.currentUser.subscribe(e=>this.userId=e.userId)}connection(){this.hubConnection=(new D).withUrl(this.signalRUrl+"?userId="+this.userId).build(),this.hubConnection.start().then(()=>{this.onUserHaveNewMessage(),this.onReadMessageFromRoom(),this.hubConnection.on("updateMessageStatusToUser_"+this.userId,e=>this.updateMessageStatusToUser.next(e)),this.hubConnection.on("typingMessageToUser_"+this.userId,e=>this.typingMessageToUser.next(e)),this.hubConnection.on("userConnectionStatus_"+this.userId,e=>this.userConnectionStatus.next(e)),this.hubConnection.on("removeMessageToUser_"+this.userId,e=>this.removeMessageToUser.next(e)),this.hubConnection.on("editMessageToUser_"+this.userId,e=>this.editMessageToUser.next(e)),this.hubConnection.on("userHaveNewRoom_"+this.userId,e=>this.userHaveNewRoom.next(e)),this.hubConnection.on("roomUpdateDataToUser_"+this.userId,e=>this.roomUpdateDataToUser.next(e)),this.hubConnection.on("aMinutePassed_"+this.userId,()=>this.userAMinutePassed.next(new Date)),this.hubConnection.on("callVideoToUser_"+this.userId,e=>this.callVideoToUser.next(e)),this.hubConnection.on("userAcceptOrRejectCall_"+this.userId,e=>this.userAcceptOrRejectCall.next(e)),this.hubConnection.on("userExitCall_"+this.userId,e=>this.userExitCall.next(e)),this.hubConnection.on("numberOfRoomUnreadMessage_"+this.userId,e=>this.numberOfRoomUnreadMessage.next(e)),this.hubConnection.on("memberUpdateNicknameToUser_"+this.userId,e=>this.memberUpdateNicknameToUser.next(e)),this.hubConnection.on("userOutRoom_"+this.userId,e=>this.userOutRoom.next(e)),this.connectedSub.next(!0),this.connected=!0}).catch(e=>console.log(e))}joinGroup(e){this.hubConnection.invoke("JoinGroup",e),this.hubConnection.on("messageToRoom_"+e,e=>this.newMessageToRoom.next(e)),this.hubConnection.on("forwardMessageToRoom_"+e,e=>this.forwardMessageToRoom.next(e)),this.hubConnection.on("updateMessageStatus_"+e,e=>this.updateMessageStatusInRoom.next(e)),this.hubConnection.on("userReadMessage_"+e,e=>this.userReadMessage.next(e)),this.hubConnection.on("userTypingMessage_"+e,e=>this.userTypingMessage.next(e)),this.hubConnection.on("removeMessageFromRoom_"+e,e=>this.removeMessageFromRoom.next(e)),this.hubConnection.on("editMessageToRoom_"+e,e=>this.editMessageToRoom.next(e)),this.hubConnection.on("roomHaveNewUser_"+e+"_userId_"+this.userId,e=>this.roomHaveNewUser.next(e)),this.hubConnection.on("roomUpdateDataToRoom_"+e,e=>this.roomUpdateDataToRoom.next(e)),this.hubConnection.on("memberUpdateNicknameInRoom_"+e,e=>this.memberUpdateNicknameInRoom.next(e)),this.hubConnection.on("roomUpdateAdministrator_"+e,e=>this.roomUpdateAdministrator.next(e)),this.hubConnection.on("roomRemoveMember_"+e,e=>this.roomRemoveMember.next(e))}leaveGroup(e){this.hubConnection.invoke("LeaveGroup",e).then(()=>{this.hubConnection.off("messageToRoom_"+e),this.hubConnection.off("forwardMessageToRoom_"+e),this.hubConnection.off("updateMessageStatus_"+e),this.hubConnection.off("userReadMessage_"+e),this.hubConnection.off("userTypingMessage_"+e),this.hubConnection.off("removeMessageFromRoom_"+e),this.hubConnection.off("editMessageToRoom_"+e),this.hubConnection.off("roomHaveNewUser_"+e+"_userId_"+this.userId),this.hubConnection.off("roomUpdateDataToRoom_"+e),this.hubConnection.off("memberUpdateNicknameInRoom_"+e),this.hubConnection.off("roomUpdateAdministrator_"+e),this.hubConnection.off("roomRemoveMember_"+e)})}onUserHaveNewMessage(){this.hubConnection.on("userHaveNewMessage_"+this.userId,e=>{this.userHaveNewMessage.next(e)})}onReadMessageFromRoom(){this.hubConnection.on("userReadMessageFromRoom_"+this.userId,e=>{this.readMessageFromRoom.next(e)})}}return e.\u0275fac=function(t){return new(t||e)(G.LFG(W.$))},e.\u0275prov=G.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},4852:(e,t,n)=>{"use strict";n.d(t,{iW:()=>o,bv:()=>r,Lo:()=>s});class o{constructor(e,t,n,o,r,s,i,a=null,c=null,u=[]){this.id=e,this.sender=t,this.content=n,this.date=o,this.messageStatus=r,this.userRead=s,this.isMessageRecall=i,this.reply=a,this.forward=c,this.attachFiles=u}}class r{constructor(e,t){this.title=t,this.groups=e}}class s{constructor(e,t,n,o,r,s,i,a,c,u=null,l=null,h=[]){this.id=e,this.sender=t,this.date=n,this.isSend=o,this.content=r,this.contentType=s,this.isMessageRecall=i,this.messageStatus=a,this.userRead=c,this.reply=u,this.forward=l,this.attachFiles=h}}},3598:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var o=n(8619),r=n(8370),s=n(1116);let i=(()=>{class e{constructor(e,t){this.convertService=e,this.datePipe=t}transform(e){var t,n;const o=new Date,r=new Date(e);let s=o.getTime()-r.getTime(),i=Math.floor(s/864e5),a="";return 0==i?(i=o.getDate()-r.getDate(),a=i>0?this.convertService.formatDateInWeek(r):null!==(t=this.datePipe.transform(r,"HH:mm"))&&void 0!==t?t:""):a=i>0&&i<=7?this.convertService.formatDateInWeek(r):null!==(n=this.datePipe.transform(r,"HH:mm, dd/MM/yyyy"))&&void 0!==n?n:"",a}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.w,16),o.Y36(s.uU,16))},e.\u0275pipe=o.Yjl({name:"messageTimes",type:e,pure:!0}),e})()},1198:(e,t,n)=>{"use strict";n.d(t,{X:()=>l});var o=n(529),r=n(4447),s=n(5165),i=n(4852),a=n(9996),c=n(8619),u=n(8370);let l=(()=>{class e{constructor(e,t){this.fetchApiService=e,this.convertService=t}getConversation(e,t,n,s=0){return this.fetchApiService.Get(o.N.urlAPI.getConversation+"?roomId="+e+"&skip="+t+"&pageSize="+n,s).pipe((0,a.U)(e=>{let t=e.data;var o=new r.t(0,0,e.totalPage,e.totalItem,n);return new r.l(t,o)}))}convertToConversation(e,t){if(!e)return null;let n=[],o=e;for(let r=e.length-1;r>=0;r--){let s=new Date(e[r].date),a=this.getConversationGroup(o,s,t);a=a.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());const c=this.conversationIdLooped(a);o=o.filter(e=>!c.includes(e.id)),r-=c.length>0?c.length-1:0,n.push(new i.bv(a,s))}return n=n.sort((e,t)=>new Date(t.title).getTime()-new Date(e.title).getTime()),n}conversationIdLooped(e){let t=[];for(let n=0;n<e.length;n++)t.push(...e[n].messages.map(e=>e.id));return t}getConversationGroup(e,t,n){let o=[],r=[],s="";for(let i=e.length-1;i>=0;i--){const a=e[i];let c=new Date(a.date);if(this.convertService.calcNextTimesChat(t,c)){let e=this.newConversationGroup(r,n);return null!=e&&o.push(e),o}switch(!0){case i===e.length-1&&e.length>1:r.push(a);break;case 0===i:if(s==a.sender.id)if(this.convertService.calcNextTimesChat(t,c,2)){let e=this.newConversationGroup(r,n);e&&o.push(e),r=[],r.push(a)}else r.push(a);else{let e=this.newConversationGroup(r,n);e&&o.push(e),r=[],r.push(a)}break;default:if(s!==a.sender.id){let e=this.newConversationGroup(r,n);e&&o.push(e),r=[],r.push(a)}else r.push(a)}t=c,s=a.sender.id}if(r.length>0){let e=this.newConversationGroup(r,n);e&&o.push(e)}return o}newConversationGroup(e,t){if(0===e.length)return null;const n=e[0];let o=e.map(e=>{let t=e.reply?new i.iW(e.reply.id,e.reply.sender,e.reply.content,e.reply.date,e.reply.messageStatus,e.reply.userRead,e.reply.isMessageRecall,null,null,e.reply.attachFiles):null,n=e.forward?new i.iW(e.forward.id,e.forward.sender,e.forward.content,e.forward.date,e.forward.messageStatus,e.forward.userRead,e.forward.isMessageRecall):null;return new i.iW(e.id,e.sender,e.content,e.date,e.messageStatus,e.userRead,e.isMessageRecall,t,n,e.attachFiles)});return{firstName:n.sender.firstName,lastName:n.sender.lastName,avatar:n.sender.avatar,nickname:n.sender.nickname,date:new Date(n.date),isSend:n.isSend,fadeinClass:t,messages:o}}getRoomDetails(e,t=0){return this.fetchApiService.Get(o.N.urlAPI.getRoomDetail+"?roomId="+e,t).pipe((0,a.U)(e=>e.data))}sendMessage(e,t=0){let n=o.N.urlAPI.sendMessage;var r=new FormData;e.id&&r.append("id",e.id),e.tempId&&r.append("tempId",e.tempId),r.append("content",e.content),r.append("roomId",e.roomId),r.append("date",e.date.toUTCString()),e.replyMessageId&&r.append("replyMessageId",e.replyMessageId);for(let o=0;o<e.files.length;o++)r.append("file",e.files[o]);return this.fetchApiService.Post(r,n,!1,t).pipe((0,a.U)(e=>e.data))}updateMessageStatus(e,t=0){return this.fetchApiService.Post(null,o.N.urlAPI.updateMessageStatus+"?id="+e,!0,t)}readMessage(e,t=0){return this.fetchApiService.Post(null,o.N.urlAPI.readMessage+"?roomId="+e,!0,t)}typingMessage(e,t,n=0){return this.fetchApiService.Post(null,o.N.urlAPI.typingMessage+"?roomId="+e+"&message="+t,!0,n)}removeMessage(e,t=0){return this.fetchApiService.Post(null,o.N.urlAPI.removeMessage+"?id="+e,!0,t)}forwardMessage(e,t,n=0){return this.fetchApiService.Post(null,o.N.urlAPI.forwardMessage+"?id="+e+"&roomId="+t,!0,n)}getSharedMediaFiles(e,t,n,s=0){return this.fetchApiService.Get(o.N.urlAPI.getSharedMediaFiles+"?roomId="+e+"&pageIndex="+t+"&pageSize="+n,s).pipe((0,a.U)(e=>new r.l(e.data,new r.t(0,t,e.totalPage,e.totalPage,n))))}getMembersInRoom(e,t=0){return this.fetchApiService.Get(o.N.urlAPI.getMembersInRoom+"?roomId="+e,t).pipe((0,a.U)(e=>e.data))}callVideo(e,t,n=0){return this.fetchApiService.Post(null,o.N.urlAPI.callVideo+"?roomId="+e+"&isVideo="+t,!0,n)}editNickname(e,t=0){return this.fetchApiService.Post(JSON.stringify(e),o.N.urlAPI.editNickname,!0,t)}getMessengerMedia(e,t,n,s,i=0){return this.fetchApiService.Get(o.N.urlAPI.getMessengerMedia+"?messageId="+e+"&attachmentId="+t+"&skip="+n+"&take="+s,i).pipe((0,a.U)(e=>new r.l(e.data,new r.t(0,0,0,e.totalItem,0))))}downloadFile(e){return this.fetchApiService.downloadImage(o.N.urlAPI.downloadFile+"?fileUrl="+e)}forwardAttachmentFile(e,t,n=0){return this.fetchApiService.Post(null,o.N.urlAPI.forwardAttachmentFile+"?attachmentId="+e+"&roomId="+t,!0,n)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(s.Z),c.LFG(u.w))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1262:(e,t,n)=>{"use strict";n.d(t,{y:()=>u});var o=n(529),r=n(8318),s=n(4447),i=n(5165),a=n(9996),c=n(8619);let u=(()=>{class e{constructor(e){this.fetchApiService=e}getRooms(e,t,n,r=0){return this.fetchApiService.Get(o.N.urlAPI.getRooms+"?pageIndex="+e+"&pageSize="+t+"&roomTypeId="+n,r).pipe((0,a.U)(n=>new s.l(n.data,new s.t(0,e,n.totalPage,n.totalItem,t))))}getRoomsRecently(e=0){return this.fetchApiService.Get(o.N.urlAPI.getRoomsRecently,e).pipe((0,a.U)(e=>e.data))}searchRooms(e,t=0){return e?this.fetchApiService.Get(o.N.urlAPI.searchRooms+"?strSearch="+e,t).pipe((0,a.U)(e=>e.data)):new r.y(e=>e.next([]))}getContacts(e,t,n="",r=0){let i=o.N.urlAPI.getContacts+"?pageIndex="+e+"&pageSize="+t;return n&&(i+="&roomId="+n),this.fetchApiService.Get(i,r).pipe((0,a.U)(n=>new s.l(n.data,new s.t(0,e,n.totalPage,n.totalItem,t))))}searchContacts(e,t="",n=0){if(!e)return new r.y(e=>e.next([]));let s=o.N.urlAPI.searchContacts+"?strSearch="+e;return t&&(s+="&roomId="+t),this.fetchApiService.Get(s,n).pipe((0,a.U)(e=>e.data))}getContactInformation(e,t=0){return this.fetchApiService.Get(o.N.urlAPI.getContactInformation+"?contactId="+e,t).pipe((0,a.U)(e=>e.data))}getNumberOfRoomUnReadMessage(){return this.fetchApiService.Get(o.N.urlAPI.getNumberOfRoomUnReadMessage).pipe((0,a.U)(e=>e.data))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(i.Z))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},4349:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ClientModule:()=>m});var o=n(1116),r=n(3146),s=n(7570),i=n(8619),a=n(957),c=n(9624),u=n(1262),l=n(8370),h=n(5031),p=n(1198);const d=[{path:"",component:(()=>{class e{constructor(e,t,n,o,r,i){this.chatHubService=e,this.title=t,this.contactService=n,this.convertService=o,this.authenticationService=r,this.chatRoomService=i,this.numberOfRoomUnReadMessage=0,this.hubNumberOfRoomUnread=new s.w,this.userHaveNewMessageSubscription=new s.w}ngOnDestroy(){this.chatHubService.disconnection(),this.hubNumberOfRoomUnread.unsubscribe(),this.hubNumberOfRoomUnread.unsubscribe()}ngOnInit(){this.authenticationService.currentUser.subscribe(e=>this.user=e),this.chatHubService.connection(),this.contactService.getNumberOfRoomUnReadMessage().subscribe(e=>{this.title.setTitle(e>0?`(${e}) Your Message`:"Your Message")}),this.hubNumberOfRoomUnread=this.chatHubService.numberOfRoomUnreadMessage.subscribe(e=>{this.title.setTitle(e>0?`(${e}) Your Message`:"Your Message")}),this.userHaveNewMessageSubscription=this.chatHubService.userHaveNewMessage.subscribe(e=>{this.user.userId!==e.newestMessage.sender.id&&(this.convertService.playMessageSound("come"),this.chatRoomService.updateMessageStatus(e.newestMessage.id).subscribe())})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(a.h),i.Y36(c.Dx),i.Y36(u.y),i.Y36(l.w),i.Y36(h.$),i.Y36(p.X))},e.\u0275cmp=i.Xpm({type:e,selectors:[["ymg-client"]],decls:1,vars:0,template:function(e,t){1&e&&i._UZ(0,"router-outlet")},directives:[r.lC],encapsulation:2}),e})(),children:[{path:"t",loadChildren:()=>Promise.all([n.e(866),n.e(180),n.e(610),n.e(592),n.e(378)]).then(n.bind(n,5378)).then(e=>e.HomeModule)},{path:"profile",loadChildren:()=>Promise.all([n.e(866),n.e(180),n.e(610),n.e(592),n.e(25)]).then(n.bind(n,4025)).then(e=>e.ProfileModule)},{path:"videocall",loadChildren:()=>Promise.all([n.e(866),n.e(180),n.e(592),n.e(279)]).then(n.bind(n,7279)).then(e=>e.VideoCallModule)},{path:"",redirectTo:"t",pathMatch:"full"}]},{path:"**",redirectTo:"t",pathMatch:"full"}];let f=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[r.Bz.forChild(d)],r.Bz]}),e})();var g=n(3598);let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[o.uU,g.$],imports:[[o.ez,f]]}),e})()}}]);